import{_ as oe,i as X,r as k,k as Z,l as re,m as $,o as a,d as l,e as n,c,j as h,w as N,a as t,f as G,n as I,v as ae,F as ne,p as le,q as d,t as y,T as R,s as ie,x as de,y as ue,z as ce,u as ve,A as pe,B as E,C as fe,D as xe,E as Q,h as p,G as H,H as U,I as me}from"./index-B1RxePN7.js";import{u as ge}from"./notifications-CvwSNUEb.js";import{d as he}from"./dateUtils-KBV2qcdl.js";import{S as O}from"./constants-CFvVWKro.js";import{_ as ke}from"./Footer-DTGSL96F.js";const be={class:"p-4 border-b border-gray-200 dark:border-gray-700"},we={class:"relative"},ye=["onKeydown"],_e={class:"max-h-[60vh] overflow-y-auto"},Ce={key:0,class:"p-8 text-center"},Me={key:1,class:"p-8 text-center text-gray-500 dark:text-gray-400"},$e={key:2,class:"p-8 text-center text-gray-500 dark:text-gray-400"},je={key:3,class:"divide-y divide-gray-200 dark:divide-gray-700"},Be=["onClick","onMouseenter"],Se={class:"flex items-start space-x-3 space-x-reverse"},De={class:"flex-shrink-0"},Le={class:"flex-1 min-w-0"},Ee={class:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate"},Re={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},Ae={class:"p-3 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between text-xs text-gray-500 dark:text-gray-400"},qe={key:0},Te={__name:"GlobalSearch",setup(P,{expose:A}){const _=X(),g=k(!1),x=k(""),f=k([]),j=k(!1),u=k(-1),b=k(null),m=o=>({[O.OPEN]:"badge badge-info",[O.IN_PROGRESS]:"badge badge-warning",[O.COMPLETED]:"badge badge-success"})[o]||"badge badge-secondary",V=o=>o?he.formatDate(o,"jYYYY/jMM/jDD"):"",S=(o,r)=>{if(!r.trim())return o;const s=new RegExp(`(${r})`,"gi");return o.replace(s,'<mark class="bg-yellow-200 dark:bg-yellow-800">$1</mark>')},D=async()=>{if(!x.value.trim()){f.value=[];return}j.value=!0;try{const o=await ue.get("/requests/search",{params:{q:x.value,limit:10}});o.data.success&&(f.value=o.data.data||[],u.value=-1)}catch(o){console.error("Search error:",o),f.value=[]}finally{j.value=!1}},L=()=>{u.value>=0&&f.value[u.value]?B(f.value[u.value]):f.value.length>0&&B(f.value[0])},q=()=>{u.value<f.value.length-1&&u.value++},C=()=>{u.value>0&&u.value--},B=o=>{w(),_.push(`/requests/${o._id}`)},T=()=>{g.value=!0,x.value="",f.value=[],de(()=>{var o;(o=b.value)==null||o.focus()})},w=()=>{g.value=!1,x.value="",f.value=[],u.value=-1},M=o=>{(o.metaKey||o.ctrlKey)&&o.key==="k"&&(o.preventDefault(),g.value?w():T())};return Z(()=>{document.addEventListener("keydown",M)}),re(()=>{document.removeEventListener("keydown",M)}),A({open:T,close:w}),(o,r)=>(a(),$(ie,{to:"body"},[l(R,{name:"fade"},{default:n(()=>[g.value?(a(),c("div",{key:0,class:"fixed inset-0 z-[9999] flex items-start justify-center pt-[20vh] px-4",onClick:N(w,["self"])},[t("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl w-full max-w-2xl border border-gray-200 dark:border-gray-700",onClick:r[1]||(r[1]=N(()=>{},["stop"]))},[t("div",be,[t("div",we,[G(t("input",{ref_key:"searchInput",ref:b,"onUpdate:modelValue":r[0]||(r[0]=s=>x.value=s),type:"text",placeholder:"جستجوی درخواست‌ها، مشتری‌ها، سیستم‌ها...",class:"w-full px-4 py-3 pr-12 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary-500",onInput:D,onKeydown:[I(w,["esc"]),I(L,["enter"]),I(N(q,["prevent"]),["down"]),I(N(C,["prevent"]),["up"])]},null,40,ye),[[ae,x.value]]),r[2]||(r[2]=t("div",{class:"absolute right-3 top-1/2 transform -translate-y-1/2"},[t("svg",{class:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))])]),t("div",_e,[j.value?(a(),c("div",Ce,[...r[3]||(r[3]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1)])])):x.value.trim()?f.value.length===0?(a(),c("div",$e,[...r[5]||(r[5]=[t("p",null,"نتیجه‌ای یافت نشد",-1)])])):(a(),c("div",je,[(a(!0),c(ne,null,le(f.value,(s,z)=>(a(),c("div",{key:s._id,class:d(["p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",u.value===z?"bg-gray-50 dark:bg-gray-700":""]),onClick:K=>B(s),onMouseenter:K=>u.value=z},[t("div",Se,[t("div",De,[t("span",{class:d([m(s.status),"badge"])},y(s.status),3)]),t("div",Le,[t("p",Ee,y(S(s.request||"",x.value)),1),t("p",Re,y(s.customerName)+" • "+y(s.system)+" • "+y(V(s.date)),1)])])],42,Be))),128))])):(a(),c("div",Me,[...r[4]||(r[4]=[t("p",null,"برای جستجو تایپ کنید...",-1),t("p",{class:"text-xs mt-2"},"می‌توانید از کلیدهای میانبر استفاده کنید",-1)])]))]),t("div",Ae,[r[6]||(r[6]=t("div",{class:"flex items-center space-x-4 space-x-reverse"},[t("span",null,"↑↓ برای حرکت"),t("span",null,"Enter برای انتخاب"),t("span",null,"Esc برای بستن")],-1)),f.value.length>0?(a(),c("span",qe,y(f.value.length)+" نتیجه",1)):h("",!0)])])])):h("",!0)]),_:1})]))}},ze=oe(Te,[["__scopeId","data-v-ed4a9ddd"]]),Ne={class:"sticky top-0 z-50 border-b border-white/30 bg-glass backdrop-blur-xl shadow-soft"},Ie={class:"mx-auto flex w-full max-w-7xl flex-col gap-3 px-4 py-3 sm:px-6 lg:px-8"},Ue={class:"flex items-center gap-3 lg:gap-6"},Ve=["aria-expanded"],Ke={key:0,class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Oe={key:1,class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ge={class:"hidden lg:flex items-center gap-2 xl:gap-3"},Pe=["aria-expanded"],Ye={class:"flex items-center gap-1"},Fe={class:"absolute left-0 mt-3 w-56 rounded-3xl border border-white/40 bg-white/80 p-3 shadow-soft backdrop-blur-xl"},He={class:"flex items-center justify-end gap-2 sm:gap-3"},We={key:0,class:"absolute -top-1.5 -right-1.5 flex h-5 w-5 items-center justify-center rounded-full bg-gradient-to-r from-danger-500 to-danger-400 text-[11px] font-semibold text-white shadow-soft"},Je=["title"],Xe={key:0,class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ze={key:1,class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Qe={class:"flex h-10 w-10 items-center justify-center rounded-2xl bg-gradient-to-br from-brand-500 via-iris-500 to-teal-500 text-base font-bold text-white shadow-glow"},et={class:"hidden md:block truncate max-w-[140px]"},tt={class:"absolute left-0 mt-3 w-52 rounded-3xl border border-white/40 bg-white/80 p-3 shadow-soft backdrop-blur-xl"},st={key:0,class:"md:hidden overflow-hidden rounded-3xl border border-white/40 bg-white/80 p-4 shadow-soft backdrop-blur-xl"},ot={class:"flex flex-col gap-2 text-sm font-medium text-smoke-600"},rt={key:3,class:"mt-2 grid gap-2 pt-2"},W="rounded-2xl px-4 py-2 text-sm font-semibold text-smoke-500 transition-all duration-200 ease-spring hover:-translate-y-0.5 hover:text-brand-600 hover:bg-white/80",J="bg-white/90 text-brand-600 shadow-inner",at={__name:"Header",setup(P){const A=X(),_=ce(),g=ve(),x=ge(),{isDark:f,toggleDarkMode:j}=pe(),u=k(!1),b=k(!1),m=k(!1),V=k(null),S=k(null),D=k(null),L=E(()=>g.user),q=E(()=>g.isAdmin),C=E(()=>g.isCustomer),B=E(()=>x.unreadCount),T=E(()=>{var e;return(e=L.value)!=null&&e.name?L.value.name.split(" ").map(i=>i[0]).join("").toUpperCase():"?"}),w=v=>Array.isArray(v)?v.some(e=>w(e)):v==="/"?_.path==="/":_.path.startsWith(v),M=v=>[W,w(v)?J:""],o=v=>["block rounded-2xl px-4 py-2 text-sm font-medium text-smoke-600 transition-all duration-200 hover:bg-white/70 hover:text-brand-600",w(v)?"bg-white/80 text-brand-600":""],r=v=>["rounded-2xl border border-transparent px-4 py-2 transition-all duration-200 hover:border-white/40 hover:bg-white/70",w(v)?"border-white/50 bg-white/80 text-brand-600 shadow-inner":""],s=()=>{u.value=!1,b.value=!1,m.value=!1},z=()=>{b.value=!b.value,b.value&&(u.value=!1,m.value=!1)},K=()=>{m.value=!m.value,m.value&&(u.value=!1)},ee=()=>{u.value=!u.value,u.value&&(m.value=!1,b.value=!1)},te=async()=>{try{await g.logout(),s(),A.push("/login")}catch(v){console.error("Logout error:",v)}},Y=v=>{S.value&&!S.value.contains(v.target)&&(m.value=!1),D.value&&!D.value.contains(v.target)&&(u.value=!1)};return Z(async()=>{if(g.user)try{await x.fetchNotifications()}catch(v){console.error("Failed to fetch notifications:",v)}document.addEventListener("click",Y)}),fe(()=>{document.removeEventListener("click",Y)}),xe(()=>_.fullPath,()=>{s()}),(v,e)=>{var F;const i=Q("router-link");return a(),c("header",Ne,[t("div",Ie,[t("div",Ue,[t("button",{onClick:z,class:"flex h-11 w-11 items-center justify-center rounded-2xl border border-white/40 bg-white/70 text-smoke-500 transition-all duration-200 ease-spring hover:-translate-y-0.5 hover:text-brand-600 hover:shadow-soft md:hidden","aria-label":"باز و بسته کردن منو","aria-expanded":b.value},[b.value?(a(),c("svg",Oe,[...e[2]||(e[2]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.8",d:"M6 18L18 6M6 6l12 12"},null,-1)])])):(a(),c("svg",Ke,[...e[1]||(e[1]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.8",d:"M4 6h16M4 12h16M4 18h16"},null,-1)])]))],8,Ve),l(i,{to:"/",class:"group flex flex-1 items-center gap-2 overflow-hidden rounded-2xl border border-transparent px-1 py-1 text-sm font-semibold duration-300 ease-spring"},{default:n(()=>[...e[3]||(e[3]=[t("span",{class:"flex h-11 w-11 items-center justify-center rounded-2xl bg-gradient-to-br from-brand-500 via-iris-500 to-teal-500 text-white shadow-glow"}," ر‌س ",-1),t("span",{class:"truncate text-base font-extrabold tracking-tight text-smoke-900 sm:text-lg lg:text-xl gradient-text"}," سیستم مدیریت فرآیند رایسا و سامیار ",-1)])]),_:1}),t("nav",Ge,[l(i,{class:d(M("/")),to:"/"},{default:n(()=>[...e[4]||(e[4]=[p(" داشبورد ",-1)])]),_:1},8,["class"]),l(i,{class:d(M("/requests")),to:"/requests"},{default:n(()=>[...e[5]||(e[5]=[p(" درخواست‌ها ",-1)])]),_:1},8,["class"]),C.value?h("",!0):(a(),$(i,{key:0,class:d(M("/reports")),to:"/reports"},{default:n(()=>[...e[6]||(e[6]=[p(" گزارش‌ها ",-1)])]),_:1},8,["class"])),C.value?h("",!0):(a(),$(i,{key:1,class:d(M("/scheduled-reports")),to:"/scheduled-reports"},{default:n(()=>[...e[7]||(e[7]=[p(" گزارش‌های زمان‌بندی ",-1)])]),_:1},8,["class"])),C.value?h("",!0):(a(),$(i,{key:2,class:d(M("/export-history")),to:"/export-history"},{default:n(()=>[...e[8]||(e[8]=[p(" تاریخچه خروجی ",-1)])]),_:1},8,["class"])),q.value?(a(),c("div",{key:3,class:"relative",ref_key:"managementMenuRef",ref:S},[t("button",{type:"button",onClick:K,class:d([W,m.value?J:""]),"aria-expanded":m.value,"aria-haspopup":"true"},[t("span",Ye,[e[10]||(e[10]=p(" مدیریت ",-1)),(a(),c("svg",{class:d(["h-4 w-4 transition-transform duration-200",{"rotate-180":m.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...e[9]||(e[9]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.6",d:"M19 9l-7 7-7-7"},null,-1)])],2))])],10,Pe),l(R,{name:"menu"},{default:n(()=>[G(t("div",Fe,[l(i,{to:"/admin",class:d(o("/admin")),onClick:s},{default:n(()=>[...e[11]||(e[11]=[p(" داشبورد مدیریت ",-1)])]),_:1},8,["class"]),l(i,{to:"/admin/users",class:d(o("/admin/users")),onClick:s},{default:n(()=>[...e[12]||(e[12]=[p(" مدیریت کاربران ",-1)])]),_:1},8,["class"]),l(i,{to:"/admin/customers",class:d(o("/admin/customers")),onClick:s},{default:n(()=>[...e[13]||(e[13]=[p(" مشتریان ",-1)])]),_:1},8,["class"]),l(i,{to:"/admin/specialists",class:d(o("/admin/specialists")),onClick:s},{default:n(()=>[...e[14]||(e[14]=[p(" متخصصین ",-1)])]),_:1},8,["class"])],512),[[H,m.value]])]),_:1})],512)):h("",!0)]),t("div",He,[l(ze,{ref_key:"globalSearchRef",ref:V},null,512),l(i,{to:"/notifications",class:"group relative flex h-11 w-11 items-center justify-center rounded-2xl border border-white/30 bg-white/70 text-smoke-500 transition-all duration-200 ease-spring hover:-translate-y-0.5 hover:text-brand-600 hover:shadow-soft"},{default:n(()=>[e[15]||(e[15]=t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.6",d:"M15 17h5l-1.4-1.4c-.38-.38-.6-.89-.6-1.42V11a6 6 0 00-4-5.66V5a2 2 0 10-4 0v.34A6 6 0 006 11v3.18c0 .53-.21 1.04-.59 1.42L4 17h5m6 0v1a3 3 0 11-6 0v-1"})],-1)),B.value>0?(a(),c("span",We,y(B.value),1)):h("",!0)]),_:1}),t("button",{onClick:e[0]||(e[0]=(...se)=>U(j)&&U(j)(...se)),title:U(f)?"روشن":"تاریک",class:"flex h-11 w-11 items-center justify-center rounded-2xl border border-white/30 bg-white/70 text-smoke-500 transition-all duration-200 ease-spring hover:-translate-y-0.5 hover:text-brand-600 hover:shadow-soft"},[U(f)?(a(),c("svg",Xe,[...e[16]||(e[16]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.6",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.36 6.36l-.71-.71M6.34 6.34l-.71-.71m12.73 0l-.71.71M6.34 17.66l-.71.71M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)])])):(a(),c("svg",Ze,[...e[17]||(e[17]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.6",d:"M20.35 15.35A9 9 0 018.65 3.65 9 9 0 0012 21a9 9 0 008.35-5.65z"},null,-1)])]))],8,Je),t("div",{class:"relative",ref_key:"userMenuRef",ref:D},[t("button",{class:"flex items-center gap-2 rounded-2xl border border-white/30 bg-white/70 px-2 py-1.5 text-sm font-semibold text-smoke-600 transition-all duration-200 ease-spring hover:-translate-y-0.5 hover:text-brand-600 hover:shadow-soft",onClick:ee},[t("span",Qe,y(T.value),1),t("span",et,y((F=L.value)==null?void 0:F.name),1),(a(),c("svg",{class:d(["h-4 w-4 transition-transform duration-200",{"rotate-180":u.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...e[18]||(e[18]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.6",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),l(R,{name:"menu"},{default:n(()=>[G(t("div",tt,[l(i,{to:"/profile",class:"flex items-center justify-between gap-2 rounded-2xl px-4 py-2 text-sm font-medium text-smoke-600 transition-all duration-200 hover:bg-white/70 hover:text-brand-600",onClick:s},{default:n(()=>[...e[19]||(e[19]=[t("span",null,"پروفایل",-1),t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.6",d:"M9 5l7 7-7 7"})],-1)])]),_:1}),t("button",{onClick:te,class:"mt-2 flex w-full items-center justify-between gap-2 rounded-2xl px-4 py-2 text-sm font-semibold text-danger-600 transition-all duration-200 hover:bg-danger-50/80"},[...e[20]||(e[20]=[t("span",null,"خروج",-1),t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.6",d:"M17 16l4-4-4-4m-7 4h11M7 4v16"})],-1)])])],512),[[H,u.value]])]),_:1})],512)])]),l(R,{name:"mobile"},{default:n(()=>[b.value?(a(),c("nav",st,[t("div",ot,[l(i,{class:d(r("/")),to:"/",onClick:s},{default:n(()=>[...e[21]||(e[21]=[p(" داشبورد ",-1)])]),_:1},8,["class"]),l(i,{class:d(r("/requests")),to:"/requests",onClick:s},{default:n(()=>[...e[22]||(e[22]=[p(" درخواست‌ها ",-1)])]),_:1},8,["class"]),C.value?h("",!0):(a(),$(i,{key:0,class:d(r("/reports")),to:"/reports",onClick:s},{default:n(()=>[...e[23]||(e[23]=[p(" گزارش‌ها ",-1)])]),_:1},8,["class"])),C.value?h("",!0):(a(),$(i,{key:1,class:d(r("/scheduled-reports")),to:"/scheduled-reports",onClick:s},{default:n(()=>[...e[24]||(e[24]=[p(" گزارش‌های زمان‌بندی ",-1)])]),_:1},8,["class"])),C.value?h("",!0):(a(),$(i,{key:2,class:d(r("/export-history")),to:"/export-history",onClick:s},{default:n(()=>[...e[25]||(e[25]=[p(" تاریخچه خروجی ",-1)])]),_:1},8,["class"])),q.value?(a(),c("div",rt,[e[30]||(e[30]=t("p",{class:"text-xs uppercase tracking-[0.3em] text-smoke-400"},"مدیریت",-1)),l(i,{class:d(r("/admin")),to:"/admin",onClick:s},{default:n(()=>[...e[26]||(e[26]=[p(" داشبورد مدیریت ",-1)])]),_:1},8,["class"]),l(i,{class:d(r("/admin/users")),to:"/admin/users",onClick:s},{default:n(()=>[...e[27]||(e[27]=[p(" مدیریت کاربران ",-1)])]),_:1},8,["class"]),l(i,{class:d(r("/admin/customers")),to:"/admin/customers",onClick:s},{default:n(()=>[...e[28]||(e[28]=[p(" مشتریان ",-1)])]),_:1},8,["class"]),l(i,{class:d(r("/admin/specialists")),to:"/admin/specialists",onClick:s},{default:n(()=>[...e[29]||(e[29]=[p(" متخصصین ",-1)])]),_:1},8,["class"])])):h("",!0)])])):h("",!0)]),_:1})])])}}},nt={class:"relative min-h-screen overflow-hidden bg-aurora"},lt={class:"relative z-10 flex min-h-screen flex-col"},it={class:"mx-auto w-full max-w-7xl flex-1 px-4 pb-12 pt-6 sm:px-6 lg:px-10"},ft={__name:"MainLayout",setup(P){return(A,_)=>{const g=Q("router-view");return a(),c("div",nt,[_[0]||(_[0]=t("div",{class:"pointer-events-none fixed inset-0 z-0 opacity-80","aria-hidden":"true"},[t("div",{class:"absolute -left-24 top-4 h-[420px] w-[420px] rounded-full bg-brand-400/25 blur-3xl"}),t("div",{class:"absolute right-[-120px] top-48 h-[520px] w-[520px] rounded-full bg-iris-400/25 blur-[140px]"}),t("div",{class:"absolute bottom-[-160px] left-1/3 h-[460px] w-[460px] rounded-full bg-teal-400/20 blur-[150px]"})],-1)),t("div",lt,[l(at),t("main",it,[l(g,null,{default:n(({Component:x})=>[l(R,{name:"page",mode:"out-in"},{default:n(()=>[(a(),$(me(x)))]),_:2},1024)]),_:1})]),l(ke)])])}}};export{ft as default};
