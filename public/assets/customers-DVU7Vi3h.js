import{y as o,N as l}from"./index-B1RxePN7.js";const n={async getCustomers(s={}){return(await o.get("/customers",{params:s})).data},async getCustomer(s){return(await o.get(`/customers/${s}`)).data},async getCustomerInsights(s){return(await o.get(`/customers/${s}/insights`)).data},async createCustomer(s){return(await o.post("/customers",s)).data},async updateCustomer(s,t){return(await o.put(`/customers/${s}`,t)).data},async archiveCustomer(s){return(await o.delete(`/customers/${s}`)).data}},g=l("customers",{state:()=>({items:[],pagination:{page:1,limit:25,total:0,pages:0},loading:!1,error:null,filters:{search:"",status:"",tier:"",tag:""},selectedCustomer:null,insights:null}),actions:{async fetchCustomers(s={}){var t,a,e,i,c,u;this.loading=!0,this.error=null;try{const r=await n.getCustomers({page:this.pagination.page,limit:this.pagination.limit,...this.filters,...s});return r.success&&(this.items=r.data,this.pagination={page:((t=r.pagination)==null?void 0:t.page)||1,limit:((a=r.pagination)==null?void 0:a.limit)||25,total:((e=r.pagination)==null?void 0:e.total)||0,pages:((i=r.pagination)==null?void 0:i.pages)||0}),r}catch(r){throw this.error=((u=(c=r.response)==null?void 0:c.data)==null?void 0:u.message)||"خطا در دریافت لیست مشتریان",r}finally{this.loading=!1}},async fetchCustomer(s){this.loading=!0;try{const t=await n.getCustomer(s);return t.success&&(this.selectedCustomer=t.customer),t}finally{this.loading=!1}},async fetchCustomerInsights(s){this.loading=!0;try{const t=await n.getCustomerInsights(s);return t.success&&(this.insights=t),t}finally{this.loading=!1}},async createCustomer(s){var t,a;this.loading=!0,this.error=null;try{const e=await n.createCustomer(s);return e.success&&await this.fetchCustomers({page:1}),e}catch(e){throw this.error=((a=(t=e.response)==null?void 0:t.data)==null?void 0:a.message)||"خطا در ایجاد مشتری",e}finally{this.loading=!1}},async updateCustomer(s,t){var a,e;this.loading=!0,this.error=null;try{const i=await n.updateCustomer(s,t);return i.success&&await this.fetchCustomers(),i}catch(i){throw this.error=((e=(a=i.response)==null?void 0:a.data)==null?void 0:e.message)||"خطا در ویرایش مشتری",i}finally{this.loading=!1}},async archiveCustomer(s){this.loading=!0;try{const t=await n.archiveCustomer(s);return t.success&&await this.fetchCustomers(),t}finally{this.loading=!1}},setFilters(s){this.filters={...this.filters,...s}},resetFilters(){this.filters={search:"",status:"",tier:"",tag:""}}}});export{g as u};
