import{y as Y,N as tt,B as h,k as et,c as i,a as t,d as f,e as w,E as st,T as ot,o as r,h as x,F as g,p as m,t as a,m as K,j as _,q as rt}from"./index-B1RxePN7.js";import{S as Q}from"./SimpleChart-JDhmnGq3.js";import{f as k,C as at,g as it}from"./constants-CFvVWKro.js";const dt={async getOverview(y={}){return(await Y.get("/dashboard/admin-overview",{params:y})).data}},lt=tt("adminDashboard",{state:()=>({overview:null,loading:!1,error:null}),actions:{async fetchOverview(y={}){var c,p;this.loading=!0,this.error=null;try{const o=await dt.getOverview(y);return o.success&&(this.overview=o),o}catch(o){throw this.error=((p=(c=o.response)==null?void 0:c.data)==null?void 0:p.message)||"خطا در دریافت داده‌های داشبورد مدیریت",o}finally{this.loading=!1}}}}),nt={class:"space-y-6"},ct={class:"flex flex-col gap-4 rounded-2xl border border-gray-100 bg-white/70 p-4 md:flex-row md:items-center md:justify-between md:p-6 shadow-sm"},xt={class:"flex flex-wrap items-center gap-2 sm:gap-3 md:justify-end"},gt=["disabled"],mt={key:"dashboard-loading",class:"space-y-6"},pt={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 xl:grid-cols-4"},ut={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},bt={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},yt={key:"dashboard-content",class:"space-y-6"},ht={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 xl:grid-cols-4"},vt={class:"rounded-2xl border border-gray-100 bg-gradient-to-br from-white to-gray-50 p-5 shadow-sm ring-1 ring-transparent transition hover:shadow-md hover:ring-primary-100"},ft={class:"mt-4 text-3xl font-extrabold text-gray-900 md:text-4xl"},wt={class:"mt-1 text-sm text-gray-500"},_t={class:"font-semibold text-primary-600"},kt={class:"rounded-2xl border border-emerald-100 bg-gradient-to-br from-emerald-50 via-white to-white p-5 shadow-sm ring-1 ring-transparent transition hover:shadow-md hover:ring-emerald-100"},St={class:"mt-4 text-3xl font-extrabold text-emerald-700 md:text-4xl"},jt={class:"mt-1 text-sm text-emerald-600"},Ct={class:"font-semibold"},At={class:"rounded-2xl border border-indigo-100 bg-gradient-to-br from-indigo-50 via-white to-white p-5 shadow-sm ring-1 ring-transparent transition hover:shadow-md hover:ring-indigo-100"},Bt={class:"mt-4 text-3xl font-extrabold text-indigo-700 md:text-4xl"},Lt={class:"mt-1 text-sm text-indigo-600"},Tt={class:"font-semibold"},Et={class:"rounded-2xl border border-sky-100 bg-gradient-to-br from-sky-50 via-white to-white p-5 shadow-sm ring-1 ring-transparent transition hover:shadow-md hover:ring-sky-100"},Mt={class:"mt-4 text-3xl font-extrabold text-sky-700 md:text-4xl"},Rt={class:"mt-1 text-sm text-sky-600"},Ot={class:"font-semibold"},Dt={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},Nt={class:"rounded-2xl border border-gray-100 bg-white/80 p-5 shadow-sm"},Ut={class:"mt-4 rounded-2xl border border-gray-100 bg-white p-4"},$t={key:1,class:"py-10 text-center text-sm text-gray-500"},zt={class:"rounded-2xl border border-gray-100 bg-white/80 p-5 shadow-sm"},It={class:"mt-4 rounded-2xl border border-gray-100 bg-white p-4"},Vt={key:1,class:"py-10 text-center text-sm text-gray-500"},Ft={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},Ht={class:"rounded-2xl border border-gray-100 bg-white/80 p-5 shadow-sm"},qt={class:"mt-4 divide-y divide-gray-100"},Pt={class:"text-sm font-semibold text-gray-900"},Zt={class:"mt-1 text-xs text-gray-500 sm:text-sm"},Gt={class:"mt-1 text-xs text-gray-400"},Jt={key:0,class:"py-10 text-center text-sm text-gray-500"},Kt={class:"rounded-2xl border border-gray-100 bg-white/80 p-5 shadow-sm"},Qt={class:"mt-4 overflow-x-auto rounded-2xl border border-gray-100"},Wt={class:"min-w-full divide-y divide-gray-100 text-sm"},Xt={class:"divide-y divide-gray-100 bg-white"},Yt={class:"px-4 py-3"},te={class:"font-semibold text-gray-900"},ee={key:0,class:"mt-1 text-xs text-gray-500"},se={class:"px-4 py-3 text-gray-900 font-semibold"},oe={class:"px-4 py-3 text-amber-600 font-semibold"},re={class:"px-4 py-3 text-emerald-600 font-semibold"},ae={key:0},ne={__name:"AdminDashboard",setup(y){const c=lt(),p=h(()=>c.loading),o=h(()=>c.overview),S=async()=>{await c.fetchOverview()};et(()=>{S()});const j=d=>at[d]||"—",W=d=>it[d]||"نامشخص",v=h(()=>{var e;const d=((e=o.value)==null?void 0:e.topCustomers)||[];return{data:{labels:d.map(l=>l.name),datasets:[{label:"کل درخواست‌ها",backgroundColor:"#3b82f6",borderRadius:6,data:d.map(l=>l.total)},{label:"باز",backgroundColor:"#facc15",borderRadius:6,data:d.map(l=>l.open)},{label:"انجام‌شده",backgroundColor:"#22c55e",borderRadius:6,data:d.map(l=>l.completed)}]},options:{scales:{y:{beginAtZero:!0,ticks:{stepSize:1}},x:{ticks:{maxRotation:0,minRotation:0,autoSkip:!1}}}}}}),C=h(()=>{var u,b;const d=((b=(u=o.value)==null?void 0:u.specialists)==null?void 0:b.byStatus)||{},e=Object.keys(k).filter(n=>d[n]>0).map(n=>k[n]),l=Object.keys(k).filter(n=>d[n]>0).map(n=>d[n]);return{data:{labels:e,datasets:[{label:"وضعیت متخصصین",backgroundColor:["#22c55e","#f97316","#94a3b8"],data:l}]}}});return(d,e)=>{const l=st("router-link");return r(),i("div",nt,[t("section",ct,[e[2]||(e[2]=t("div",null,[t("p",{class:"text-xs font-semibold uppercase tracking-widest text-primary-500"}," مرکز فرمان مدیریت "),t("h1",{class:"mt-2 text-2xl font-extrabold text-gray-900 md:text-3xl"}," داشبورد مدیریت "),t("p",{class:"mt-1 text-sm text-gray-600 md:text-base"}," نمای کلی از وضعیت مشتریان، متخصصین و عملکرد سیستم ")],-1)),t("div",xt,[f(l,{to:"/admin/customers",class:"inline-flex items-center gap-2 rounded-xl border border-primary-100 bg-primary-50 px-3 py-2 text-xs font-medium text-primary-700 transition hover:bg-primary-100 sm:text-sm"},{default:w(()=>[...e[0]||(e[0]=[x(" مشتریان ",-1)])]),_:1}),f(l,{to:"/admin/specialists",class:"inline-flex items-center gap-2 rounded-xl border border-indigo-100 bg-indigo-50 px-3 py-2 text-xs font-medium text-indigo-700 transition hover:bg-indigo-100 sm:text-sm"},{default:w(()=>[...e[1]||(e[1]=[x(" متخصصین ",-1)])]),_:1}),t("button",{class:"btn btn-secondary",onClick:S,disabled:p.value}," بروزرسانی ",8,gt)])]),f(ot,{name:"fade",mode:"out-in"},{default:w(()=>{var u,b,n,A,B,L,T,E,M,R,O,D,N,U,$,z,I,V,F,H,q,P,Z,G,J;return[p.value?(r(),i("div",mt,[t("div",pt,[(r(),i(g,null,m(4,s=>t("div",{key:`dashboard-card-${s}`,class:"animate-pulse rounded-2xl border border-gray-100 bg-gray-50/60 p-5"},[...e[3]||(e[3]=[t("div",{class:"h-3 w-16 rounded bg-gray-200"},null,-1),t("div",{class:"mt-3 h-6 w-24 rounded bg-gray-200"},null,-1)])])),64))]),t("div",ut,[(r(),i(g,null,m(2,s=>t("div",{key:`dashboard-chart-${s}`,class:"animate-pulse space-y-3 rounded-2xl border border-gray-100 bg-white/80 p-5"},[...e[4]||(e[4]=[t("div",{class:"h-4 w-1/3 rounded bg-gray-200"},null,-1),t("div",{class:"h-3 w-3/4 rounded bg-gray-200"},null,-1),t("div",{class:"h-64 w-full rounded bg-gray-200"},null,-1)])])),64))]),t("div",bt,[(r(),i(g,null,m(2,s=>t("div",{key:`dashboard-list-${s}`,class:"animate-pulse space-y-3 rounded-2xl border border-gray-100 bg-white/80 p-5"},[e[5]||(e[5]=t("div",{class:"h-4 w-1/3 rounded bg-gray-200"},null,-1)),(r(),i(g,null,m(3,X=>t("div",{key:`dashboard-row-${s}-${X}`,class:"h-3 w-full rounded bg-gray-200"})),64))])),64))])])):(r(),i("div",yt,[t("section",ht,[t("article",vt,[e[7]||(e[7]=t("div",{class:"flex items-center justify-between"},[t("p",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500"}," کل مشتریان "),t("span",{class:"inline-flex h-9 w-9 items-center justify-center rounded-full bg-primary-50 text-primary-600"},[t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a4 4 0 00-4-4h-3"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 20H4v-2a4 4 0 014-4h3"}),t("circle",{cx:"9",cy:"7",r:"4","stroke-width":"2"}),t("circle",{cx:"17",cy:"7",r:"4","stroke-width":"2"})])])],-1)),t("p",ft,a(((b=(u=o.value)==null?void 0:u.customers)==null?void 0:b.total)||0),1),t("p",wt,[e[6]||(e[6]=x(" فعال: ",-1)),t("span",_t,a(((A=(n=o.value)==null?void 0:n.customers)==null?void 0:A.active)||0),1)])]),t("article",kt,[e[9]||(e[9]=t("div",{class:"flex items-center justify-between"},[t("p",{class:"text-xs font-semibold uppercase tracking-wide text-emerald-600"}," مشتریان فعال "),t("span",{class:"inline-flex h-9 w-9 items-center justify-center rounded-full bg-emerald-100 text-emerald-600"},[t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])])],-1)),t("p",St,a(((L=(B=o.value)==null?void 0:B.customers)==null?void 0:L.active)||0),1),t("p",jt,[e[8]||(e[8]=x(" فرصت‌ها: ",-1)),t("span",Ct,a(((E=(T=o.value)==null?void 0:T.customers)==null?void 0:E.prospect)||0),1)])]),t("article",At,[e[11]||(e[11]=t("div",{class:"flex items-center justify-between"},[t("p",{class:"text-xs font-semibold uppercase tracking-wide text-indigo-600"}," متخصصین "),t("span",{class:"inline-flex h-9 w-9 items-center justify-center rounded-full bg-indigo-100 text-indigo-600"},[t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.12 19.88A9 9 0 0112 15a9 9 0 017.88 4.88"})])])],-1)),t("p",Bt,a(((R=(M=o.value)==null?void 0:M.specialists)==null?void 0:R.total)||0),1),t("p",Lt,[e[10]||(e[10]=x(" آماده به کار: ",-1)),t("span",Tt,a(((N=(D=(O=o.value)==null?void 0:O.specialists)==null?void 0:D.byStatus)==null?void 0:N.available)||0),1)])]),t("article",Et,[e[13]||(e[13]=t("div",{class:"flex items-center justify-between"},[t("p",{class:"text-xs font-semibold uppercase tracking-wide text-sky-600"}," میانگین بهره‌وری "),t("span",{class:"inline-flex h-9 w-9 items-center justify-center rounded-full bg-sky-100 text-sky-600"},[t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 3v10l5-5m3 12H5"})])])],-1)),t("p",Mt,a((($=(U=o.value)==null?void 0:U.specialists)==null?void 0:$.averageUtilization)||0)+"% ",1),t("p",Rt,[e[12]||(e[12]=x(" کل اختصاص‌ها: ",-1)),t("span",Ot,a(((I=(z=o.value)==null?void 0:z.specialists)==null?void 0:I.totalAssignments)||0),1)])])]),t("section",Dt,[t("article",Nt,[e[14]||(e[14]=t("div",{class:"flex items-center justify-between"},[t("div",null,[t("h2",{class:"text-lg font-semibold text-gray-900 md:text-xl"}," مشتریان برتر "),t("p",{class:"mt-1 text-xs text-gray-500 sm:text-sm"}," بر اساس تعداد کل درخواست‌های ثبت شده ")]),t("span",{class:"inline-flex items-center rounded-full bg-primary-50 px-3 py-1 text-xs font-semibold text-primary-600"}," ۲۰ مشتری ")],-1)),t("div",Ut,[v.value.data.labels.length?(r(),K(Q,{key:0,type:"bar",data:v.value.data,options:v.value.options,height:"320px"},null,8,["data","options"])):(r(),i("div",$t," داده‌ای برای نمایش وجود ندارد. "))])]),t("article",zt,[e[15]||(e[15]=t("div",{class:"flex items-center justify-between"},[t("div",null,[t("h2",{class:"text-lg font-semibold text-gray-900 md:text-xl"}," وضعیت متخصصین "),t("p",{class:"mt-1 text-xs text-gray-500 sm:text-sm"}," توزیع وضعیت کاری تیم پشتیبانی ")]),t("span",{class:"inline-flex items-center rounded-full bg-indigo-50 px-3 py-1 text-xs font-semibold text-indigo-600"}," لحظه‌ای ")],-1)),t("div",It,[C.value.data.labels.length?(r(),K(Q,{key:0,type:"doughnut",data:C.value.data,height:"320px"},null,8,["data"])):(r(),i("div",Vt," داده‌ای برای نمایش وضعیت متخصصین وجود ندارد. "))])])]),t("section",Ft,[t("article",Ht,[e[16]||(e[16]=t("div",{class:"flex items-center justify-between"},[t("div",null,[t("h2",{class:"text-lg font-semibold text-gray-900 md:text-xl"}," مشتریان تازه اضافه شده "),t("p",{class:"mt-1 text-xs text-gray-500 sm:text-sm"}," آخرین مشتریان ثبت شده در سیستم ")])],-1)),t("ul",qt,[(r(!0),i(g,null,m(((F=(V=o.value)==null?void 0:V.customers)==null?void 0:F.recent)||[],s=>(r(),i("li",{key:s._id,class:"flex items-center justify-between gap-4 py-4"},[t("div",null,[t("p",Pt,a(s.name),1),t("p",Zt,a(s.companyName||"—")+" • "+a(j(s.tier)),1),t("p",Gt,a(s.createdAt?new Date(s.createdAt).toLocaleDateString("fa-IR"):"—"),1)]),t("span",{class:rt(["badge",s.status==="active"?"badge-success":s.status==="prospect"?"badge-warning":"badge-secondary"])},a(W(s.status)),3)]))),128)),(P=(q=(H=o.value)==null?void 0:H.customers)==null?void 0:q.recent)!=null&&P.length?_("",!0):(r(),i("li",Jt," مشتری جدیدی ثبت نشده است. "))])]),t("article",Kt,[e[19]||(e[19]=t("div",{class:"flex items-center justify-between"},[t("div",null,[t("h2",{class:"text-lg font-semibold text-gray-900 md:text-xl"}," مشتریان پرترافیک "),t("p",{class:"mt-1 text-xs text-gray-500 sm:text-sm"}," وضعیت درخواست‌های باز، در جریان و انجام شده ")])],-1)),t("div",Qt,[t("table",Wt,[e[18]||(e[18]=t("thead",{class:"bg-gray-50 text-xs font-semibold uppercase tracking-wide text-gray-500"},[t("tr",null,[t("th",{class:"px-4 py-3 text-right"},"مشتری"),t("th",{class:"px-4 py-3 text-right"},"کل"),t("th",{class:"px-4 py-3 text-right"},"باز"),t("th",{class:"px-4 py-3 text-right"},"انجام شده")])],-1)),t("tbody",Xt,[(r(!0),i(g,null,m(((Z=o.value)==null?void 0:Z.topCustomers)||[],s=>(r(),i("tr",{key:s.id,class:"transition hover:bg-gray-50"},[t("td",Yt,[t("p",te,a(s.name),1),s.tier?(r(),i("p",ee,a(j(s.tier)),1)):_("",!0)]),t("td",se,a(s.total),1),t("td",oe,a(s.open),1),t("td",re,a(s.completed),1)]))),128)),(J=(G=o.value)==null?void 0:G.topCustomers)!=null&&J.length?_("",!0):(r(),i("tr",ae,[...e[17]||(e[17]=[t("td",{colspan:"4",class:"px-4 py-10 text-center text-sm text-gray-500"}," داده‌ای برای نمایش وجود ندارد. ",-1)])]))])])])])])]))]}),_:1})])}}};export{ne as default};
