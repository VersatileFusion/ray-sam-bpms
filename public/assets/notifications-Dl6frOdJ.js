import{y as o,M as c}from"./index-NaxcUE6C.js";const n={async getNotifications(){return(await o.get("/notifications")).data},async markAsRead(s){return(await o.put(`/notifications/${s}/read`)).data},async markAllAsRead(){return(await o.post("/notifications/read-all")).data},async deleteNotification(s){return(await o.delete(`/notifications/${s}`)).data}},f=c("notifications",{state:()=>({notifications:[],unreadCount:0,loading:!1,error:null}),actions:{async fetchNotifications(){var s,a;this.loading=!0,this.error=null;try{const t=await n.getNotifications();return t.success&&(this.notifications=t.data.notifications,this.unreadCount=t.data.unreadCount),t}catch(t){throw this.error=((a=(s=t.response)==null?void 0:s.data)==null?void 0:a.message)||"خطا در دریافت اعلان‌ها",t}finally{this.loading=!1}},async markAsRead(s){var a,t;try{const e=await n.markAsRead(s);if(e.success){const i=this.notifications.find(r=>r._id===s);i&&(i.read=!0),this.unreadCount=Math.max(0,this.unreadCount-1)}return e}catch(e){throw this.error=((t=(a=e.response)==null?void 0:a.data)==null?void 0:t.message)||"خطا در علامت‌گذاری",e}},async markAllAsRead(){var s,a;try{const t=await n.markAllAsRead();return t.success&&(this.notifications.forEach(e=>e.read=!0),this.unreadCount=0),t}catch(t){throw this.error=((a=(s=t.response)==null?void 0:s.data)==null?void 0:a.message)||"خطا در علامت‌گذاری",t}},async deleteNotification(s){var a,t;try{const e=await n.deleteNotification(s);return e.success&&(this.notifications=this.notifications.filter(i=>i._id!==s)),e}catch(e){throw this.error=((t=(a=e.response)==null?void 0:a.data)==null?void 0:t.message)||"خطا در حذف",e}}}});export{f as u};
